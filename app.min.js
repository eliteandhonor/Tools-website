/* ─── Search filter ─────────────────────────────────────────── */
const toolSearchEl = document.getElementById('toolSearch');
if (toolSearchEl) {
  toolSearchEl.addEventListener('input', e => {
    const q = e.target.value.toLowerCase();
    document.querySelectorAll('.tool-card').forEach(card => {
      card.style.display = card.textContent.toLowerCase().includes(q)
        ? 'block'
        : 'none';
    });
  });
}

/* ─── Dark-mode toggle ──────────────────────────────────────── */
const darkCss    = document.getElementById('darkCss');
const themeToggle = document.getElementById('themeToggle');

if (themeToggle && darkCss) {
  // Apply saved preference on first load
  const applyStoredTheme = () => {
    if (localStorage.getItem('theme') === 'dark') darkCss.media = 'all';
  };

  themeToggle.addEventListener('click', () => {
    darkCss.media =
      darkCss.media === 'all' ? '(prefers-color-scheme: dark)' : 'all';
    darkCss.media === 'all'
      ? localStorage.setItem('theme', 'dark')
      : localStorage.removeItem('theme');
  });

  applyStoredTheme();
}

/* ─── Copy-to-clipboard buttons ─────────────────────────────── */
document.querySelectorAll('.copy-btn').forEach(btn => {
  // Resolve the target element by id OR name
  const targetEl =
    document.getElementById(btn.dataset.target) ||
    document.querySelector(`[name='${btn.dataset.target}'], #${btn.dataset.target}`);

  btn.addEventListener('click', () => {
    if (!targetEl) return;

    const val =
      targetEl.value !== undefined ? targetEl.value : targetEl.textContent;
    navigator.clipboard.writeText(val);
    btn.textContent = 'Copied!';
    setTimeout(() => (btn.textContent = 'Copy'), 1000);
  });
});
