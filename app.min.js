<script>
/* ─── Search filter ─────────────────────────────────────────── */
const toolSearchEl = document.getElementById('toolSearch');
if (toolSearchEl) {
  toolSearchEl.addEventListener('input', e => {
    const q = e.target.value.toLowerCase();
    document
      .querySelectorAll('.tool-card')
      .forEach(card => {
        card.style.display = card.textContent.toLowerCase().includes(q)
          ? 'block'
          : 'none';
      });
  });
}

/* ─── Dark-mode toggle ───────────────────────────────────────── */
const darkCss = document.getElementById('darkCss');
const themeToggle = document.getElementById('themeToggle');

if (themeToggle && darkCss) {
  // Apply stored theme on first load
  const applyStoredTheme = () => {
    if (localStorage.getItem('theme') === 'dark') {
      darkCss.media = 'all';
    }
  };

  themeToggle.addEventListener('click', () => {
    darkCss.media =
      darkCss.media === 'all' ? '(prefers-color-scheme: dark)' : 'all';
    if (darkCss.media === 'all') {
      localStorage.setItem('theme', 'dark');
    } else {
      localStorage.removeItem('theme');
    }
  });

  applyStoredTheme();
}

/* ─── Copy-to-clipboard buttons ─────────────────────────────── */
document.querySelectorAll('.copy-btn').forEach(btn => {
  // Try matching by id, name, or fallback via selector
  const targetEl =
    document.getElementById(btn.dataset.target) ||
    document.querySelector(
      `[name='${btn.dataset.target}'], #${btn.dataset.target}`
    );

  btn.addEventListener('click', () => {
    if (targetEl) {
      // Prefer .value for inputs/textarea, otherwise textContent
      const val =
        targetEl.value !== undefined ? targetEl.value : targetEl.textContent;
      navigator.clipboard.writeText(val);
      btn.textContent = 'Copied!';
      setTimeout(() => (btn.textContent = 'Copy'), 1000);
    }
  });
});
</script>
